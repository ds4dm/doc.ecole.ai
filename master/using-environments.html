

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using Environments &mdash; Ecole 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Use Observation Functions" href="howto/observation-functions.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/ecole-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using Environments</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general-structure">General structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#environment-parameters">Environment parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reseting-environments">Reseting environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#transitioning">Transitioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="#seeding-environments">Seeding environments</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">How to</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="howto/observation-functions.html">Use Observation Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="howto/reward-functions.html">Use Reward Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="howto/create-functions.html">Create New Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="howto/create-environments.html">Create New Environments</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/ds4dm/ecole/tree/master/examples/configuring-bandits.ipynb">Configuring the Solver with Bandits</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/ds4dm/ecole/tree/master/examples/branching-imitation.ipynb">Branching with Imitation Learning</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="reference/environments.html">Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference/observations.html">Observations</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference/rewards.html">Rewards</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference/scip-interface.html">SCIP Interface</a></li>
</ul>
<p class="caption"><span class="caption-text">Discussion</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="discussion/gym-differences.html">Differences with OpenAi Gym</a></li>
<li class="toctree-l1"><a class="reference internal" href="discussion/seeding.html">Seeding</a></li>
<li class="toctree-l1"><a class="reference internal" href="discussion/theory.html">Ecole Theoretical Model</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Ecole</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Using Environments</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/ds4dm/ecole/blob/master/docs/using-environments.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-environments">
<h1>Using Environments<a class="headerlink" href="#using-environments" title="Permalink to this headline">Â¶</a></h1>
<p>Environments are a stateful classes representing a control task (or Markov Decision
Process).
After instantiation of an environment, a call to
<a class="reference internal" href="reference/environments.html#ecole.environment.EnvironmentComposer.reset" title="ecole.environment.EnvironmentComposer.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> will bring the process to its
initial state, then successive calls to
<a class="reference internal" href="reference/environments.html#ecole.environment.EnvironmentComposer.step" title="ecole.environment.EnvironmentComposer.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code></a> will take an action from the
user and transition to the next state.
When the episode is finished, <em>i.e</em> when the combinatorial optimization algorithm
terminates, a new one can be started with another call to
<a class="reference internal" href="reference/environments.html#ecole.environment.EnvironmentComposer.reset" title="ecole.environment.EnvironmentComposer.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a>.</p>
<p>For instance, using the <a class="reference internal" href="reference/environments.html#ecole.environment.Branching" title="ecole.environment.Branching"><code class="xref py py-class docutils literal notranslate"><span class="pre">Branching</span></code></a> environment for
branch-and-bound variable selection, always selecting the first fractional variable would
look like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ecole</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">ecole</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">Branching</span><span class="p">()</span>
<span class="n">env</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">observation</span><span class="p">,</span> <span class="n">action_set</span><span class="p">,</span> <span class="n">reward_offset</span><span class="p">,</span> <span class="n">done</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="s2">&quot;path/to/problem&quot;</span><span class="p">)</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
        <span class="n">obs</span><span class="p">,</span> <span class="n">action_set</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action_set</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>There are few things to note in this example, let us break it down below.</p>
<div class="section" id="general-structure">
<h2>General structure<a class="headerlink" href="#general-structure" title="Permalink to this headline">Â¶</a></h2>
<p>The example is driven by two loops.
The inner <code class="docutils literal notranslate"><span class="pre">while</span></code> loop transitions until a terminal state, signaled
with the variable <code class="docutils literal notranslate"><span class="pre">done</span></code> in the example, is reached.
This loop matches the following figure usually found in reinforcement learning
presentations.
In Ecole, this loop typically terminates at the same time as the combinatorial
optimization algorithm used in the environment.
A full execution of this loop is known as an <em>episode</em>.</p>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="_images/mdp.png"><img alt="Markov Decision Process interaction loop" src="_images/mdp.png" style="width: 60%;" /></a>
<p class="caption"><span class="caption-text">The control loop of the Markov Decision Process</span><a class="headerlink" href="#id3" title="Permalink to this image">Â¶</a></p>
</div>
<p>The outter <code class="docutils literal notranslate"><span class="pre">for</span></code> loop only repeats the inner one mutiple times.
Few learning algorithms are able to learn in a single episode, so numerous ones are
usually required.
Usually, although not demonstrated here, one should not use a unique combinatorial problem
instance for all episodes.
This is because an there is no practical interest in solving again an instance already
solved.
One wants to find a policy able to genralize to new, unseen, instances.</p>
</div>
<div class="section" id="environment-parameters">
<span id="id1"></span><h2>Environment parameters<a class="headerlink" href="#environment-parameters" title="Permalink to this headline">Â¶</a></h2>
<p>Environment can be created with no constructor arguments, as in the previous examples.
This will use all the defaults chosen for the environments.</p>
<p>Each environment can have its own set of parameters to further customize the task being
solved.
For instance, the <a class="reference internal" href="reference/environments.html#ecole.environment.Branching" title="ecole.environment.Branching"><code class="xref py py-class docutils literal notranslate"><span class="pre">Branching</span></code></a> takes a <code class="docutils literal notranslate"><span class="pre">pseudo_candidates</span></code>
boolean parameter to decide whether branching candidates are chosen among all non fixed
inegral variables rather than being limited to fractional ones.</p>
<p>The constructor can optionally take a dictionnary of default
<a class="reference external" href="https://scip.zib.de/doc/html/PARAMETERS.php">SCIP parameters</a> that will be used to
initialize the solver at every episode.
For instance, to customize the clique inequalities generated, one could set:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">env</span> <span class="o">=</span> <span class="n">ecole</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">Branching</span><span class="p">(</span>
    <span class="n">scip_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;separating/clique/freq&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;separating/clique/maxsepacuts&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Depending on the nature of the environment, some user given parameters can be overriden
or ignored (<em>e.g.</em> branching parameters in the <a class="reference internal" href="reference/environments.html#ecole.environment.Branching" title="ecole.environment.Branching"><code class="xref py py-class docutils literal notranslate"><span class="pre">Branching</span></code></a>
environment).
It is the responsability of the user to understand the envrionment they are using.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For out-out-the-box strategies on presolving, heurisitcs, and cutting planes, consider
using the dedicated
<a class="reference external" href="https://scip.zib.de/doc/html/group__ParameterMethods.php">SCIP methods</a>
(<code class="docutils literal notranslate"><span class="pre">SCIPsetHeuristics</span></code> <em>etc.</em>).</p>
</div>
<p><a class="reference internal" href="howto/observation-functions.html#use-observation-functions"><span class="std std-ref">Observation functions</span></a> and
<a class="reference internal" href="howto/observation-functions.html#use-observation-functions"><span class="std std-ref">reward functions</span></a> are more advanced environment
parameters dicsussed later on.</p>
</div>
<div class="section" id="reseting-environments">
<span id="id2"></span><h2>Reseting environments<a class="headerlink" href="#reseting-environments" title="Permalink to this headline">Â¶</a></h2>
<p>The episode in the inner <code class="docutils literal notranslate"><span class="pre">while</span></code> starts with a call to
<a class="reference internal" href="reference/environments.html#ecole.environment.EnvironmentComposer.reset" title="ecole.environment.EnvironmentComposer.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> to bring the environment to a new
initial state.
The problem instance is given to parametrize the episode: it is that combinatorial
optimization problem that will be solved by the <a class="reference external" href="https://scip.zib.de/">SCIP</a> solver
during the next episode.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">observation</span></code> is for the user to decide what the next action will be (typically
using a machine learning algorithm).</p></li>
<li><p>An <code class="docutils literal notranslate"><span class="pre">action_set</span></code> is sometimes given to further reduce the set of candidate
actions to deal with highly dynamic actions sets.
It is valid for the next transition only.
For instance in <a class="reference internal" href="reference/environments.html#ecole.environment.Branching" title="ecole.environment.Branching"><code class="xref py py-class docutils literal notranslate"><span class="pre">Branching</span></code></a> the set of variable the algorithm
can branch on changes at very node (<em>i.e.</em> state).
Therefore the user needs to be constantly given the set of fractional variables.</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">reward_offset</span></code> is given even though no action has been taken.
It has not purpose for learning algorithms, rather it is meant for evaluating the complete solving
procedure.
When a reward is designed so that its cumulative sum match a metric, such as solving time or number
of LP iterations, then it is useful to be able to include the computation done during
<a class="reference internal" href="reference/environments.html#ecole.environment.EnvironmentComposer.reset" title="ecole.environment.EnvironmentComposer.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a>, which are returned in <code class="docutils literal notranslate"><span class="pre">reward_offset</span></code>.</p></li>
<li><p>The boolean flag <code class="docutils literal notranslate"><span class="pre">done</span></code> indicates wether the state is terminal.
This can hapen in <a class="reference internal" href="reference/environments.html#ecole.environment.Branching" title="ecole.environment.Branching"><code class="xref py py-class docutils literal notranslate"><span class="pre">Branching</span></code></a> where the problem instance
can be resolved though presolving only (never reaching branch-and-bound).</p></li>
</ul>
<p>See the reference section for the exact documentation of
<a class="reference internal" href="reference/environments.html#ecole.environment.EnvironmentComposer.reset" title="ecole.environment.EnvironmentComposer.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a>.</p>
</div>
<div class="section" id="transitioning">
<h2>Transitioning<a class="headerlink" href="#transitioning" title="Permalink to this headline">Â¶</a></h2>
<p>The inner <code class="docutils literal notranslate"><span class="pre">while</span></code> loop transitions the environment from one state to the next by giving
an action to <a class="reference internal" href="reference/environments.html#ecole.environment.EnvironmentComposer.step" title="ecole.environment.EnvironmentComposer.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code></a>.
The nature of <code class="docutils literal notranslate"><span class="pre">observation</span></code>, <code class="docutils literal notranslate"><span class="pre">action_set</span></code>, and <code class="docutils literal notranslate"><span class="pre">done</span></code> is the same as in the previous
section <a class="reference internal" href="#reseting-environments"><span class="std std-ref">Reseting environments</span></a>.
Furthermore a <code class="docutils literal notranslate"><span class="pre">reward</span></code> and <code class="docutils literal notranslate"><span class="pre">info</span></code> variables are given as additional information about
the current transition.</p>
<p>See the reference section for the exact documentation of
<a class="reference internal" href="reference/environments.html#ecole.environment.EnvironmentComposer.step" title="ecole.environment.EnvironmentComposer.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code></a>.</p>
</div>
<div class="section" id="seeding-environments">
<h2>Seeding environments<a class="headerlink" href="#seeding-environments" title="Permalink to this headline">Â¶</a></h2>
<p>Environments can be seeded by using the
<a class="reference internal" href="reference/environments.html#ecole.environment.EnvironmentComposer.seed" title="ecole.environment.EnvironmentComposer.seed"><code class="xref py py-meth docutils literal notranslate"><span class="pre">seed()</span></code></a> method.
The seed is used by the environment (and in particular the solver) for <em>all</em> the
subsequent trajectories.
The solver is given new seeds at the begining of every new trajectory (call to
<a class="reference internal" href="reference/environments.html#ecole.environment.EnvironmentComposer.reset" title="ecole.environment.EnvironmentComposer.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a>) in a way that preserve
determinism, but avoids using the same seeds repeatedly.</p>
<p>See the reference section for the exact documentation of
<a class="reference internal" href="reference/environments.html#ecole.environment.EnvironmentComposer.seed" title="ecole.environment.EnvironmentComposer.seed"><code class="xref py py-meth docutils literal notranslate"><span class="pre">seed()</span></code></a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="howto/observation-functions.html" class="btn btn-neutral float-right" title="Use Observation Functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Antoine Prouvost

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>